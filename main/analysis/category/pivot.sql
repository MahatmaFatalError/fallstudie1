
create or replace view categories_by_restaurant as 
(
select id, cat from (
select id, category1 as cat from restaurants_final union all select id, category2 from restaurants_final union all select id, category3 from restaurants_final ) subsel
where cat is not null
order by id desc
)

select pivotcode('categories_by_restaurant','id','cat','(cat IS NOT NULL)','boolean');
-- replace boolean, with " boolean," 
-- delete '
-- " am anfang und ende manuell

create or replace view restaurants_categories_flatter as (
select * from crosstab (
 'select id,cat,(cat IS NOT NULL) from categories_by_restaurant group by 1,2 order by 1,2',
 'select distinct cat from categories_by_restaurant order by 1'
 )
 as newtable (
 id varchar,"_Accessories " boolean,"_Accountants " boolean,"_Active Life " boolean,"_Adult Education " boolean,"_Advertising " boolean,"_Afghan " boolean,"_African " boolean,"_Alsatian " boolean,"_Amateur Sports Teams " boolean,"_American (Traditional) " boolean,"_Amusement Parks " boolean,"_Antiques " boolean,"_Apartments " boolean,"_Appliances & Repair " boolean,"_Arabian " boolean,"_Arcades " boolean,"_Architects " boolean,"_Argentine " boolean,"_Art Galleries " boolean,"_Arts & Crafts " boolean,"_Arts & Entertainment " boolean,"_Asian Fusion " boolean,"_Ateliers " boolean,"_Attraction Farms " boolean,"_Australian " boolean,"_Austrian " boolean,"_Auto Repair " boolean,"_Baby Gear & Furniture " boolean,"_Backshop " boolean,"_Baden " boolean,"_Bagels " boolean,"_Baguettes " boolean,"_Bakeries " boolean,"_Bangladeshi " boolean,"_Banks & Credit Unions " boolean,"_Barbeque " boolean,"_Barbers " boolean,"_Bars " boolean,"_Basque " boolean,"_Bavarian " boolean,"_Beach Bars " boolean,"_Beaches " boolean,"_Beauty & Spas " boolean,"_Bed & Breakfast " boolean,"_Beer Bar " boolean,"_Beer Garden " boolean,"_Beer Hall " boolean,"_Beer, Wine & Spirits " boolean,"_Belgian " boolean,"_Beverage Store " boolean,"_Bike Repair/Maintenance " boolean,"_Bikes " boolean,"_Bistros " boolean,"_Boat Charters " boolean,"_Boating " boolean,"_Books, Mags, Music & Video " boolean,"_Bookstores " boolean,"_Botanical Gardens " boolean,"_Bowling " boolean,"_Brasseries " boolean,"_Brazilian " boolean,"_Breakfast & Brunch " boolean,"_Breweries " boolean,"_Brewpubs " boolean,"_British " boolean,"_Bubble Tea " boolean,"_Buffets " boolean,"_Building Supplies " boolean,"_Bulgarian " boolean,"_Burgers " boolean,"_Cabaret " boolean,"_Cafes " boolean,"_Cafeteria " boolean,"_Cajun/Creole " boolean,"_Cambodian " boolean,"_Campgrounds " boolean,"_Candy Stores " boolean,"_Canteen " boolean,"_Car Dealers " boolean,"_Cards & Stationery " boolean,"_Caribbean " boolean,"_Car Wash " boolean,"_Casinos " boolean,"_Castles " boolean,"_Caterers " boolean,"_Champagne Bars " boolean,"_Chee Kufta " boolean,"_Cheese Shops " boolean,"_Chicken Shop " boolean,"_Chicken Wings " boolean,"_Child Care & Day Care " boolean,"_Childrens Clothing " boolean,"_Chinese " boolean,"_Chocolatiers & Shops " boolean,"_Cinema " boolean,"_Climbing " boolean,"_Cocktail Bars " boolean,"_Coffee Roasteries " boolean,"_Coffee & Tea " boolean,"_Coffee & Tea Supplies " boolean,"_Colleges & Universities " boolean,"_Comedy Clubs " boolean,"_Community Service/Non-Profit " boolean,"_Concept Shops " boolean,"_Contractors " boolean,"_Convenience Stores " boolean,"_Conveyor Belt Sushi " boolean,"_Cooking Classes " boolean,"_Cooking Schools " boolean,"_Cosmetics & Beauty Supply " boolean,"_Counseling & Mental Health " boolean,"_Couriers & Delivery Services " boolean,"_Creperies " boolean,"_CSA " boolean,"_Cuban " boolean,"_Cultural Center " boolean,"_Cupcakes " boolean,"_Curry Sausage " boolean,"_Cypriot " boolean,"_Czech " boolean,"_Dance Clubs " boolean,"_Dance Schools " boolean,"_Dance Studios " boolean,"_Day Spas " boolean,"_Delicatessen " boolean,"_Delis " boolean,"_Department Stores " boolean,"_Desserts " boolean,"_Dim Sum " boolean,"_Diners " boolean,"_Dinner Theater " boolean,"_Discount Store " boolean,"_Dive Bars " boolean,"_Diving " boolean,"_Divorce & Family Law " boolean,"_Donuts " boolean,"_Driving Schools " boolean,"_Drugstores " boolean,"_Ear Nose & Throat " boolean,"_Eastern German " boolean,"_Eatertainment " boolean,"_Education " boolean,"_Elementary Schools " boolean,"_Employment Agencies " boolean,"_Ethiopian " boolean,"_Event Planning & Services " boolean,"_Eyelash Service " boolean,"_Eyewear & Opticians " boolean,"_Fabric Stores " boolean,"_Falafel " boolean,"_Farmers Market " boolean,"_Farms " boolean,"_Fashion " boolean,"_Fast Food " boolean,"_Ferries " boolean,"_Filipino " boolean,"_Financial Services " boolean,"_Fischbroetchen " boolean,"_Fish & Chips " boolean,"_Fishing " boolean,"_Fishmonger " boolean,"_Fitness & Instruction " boolean,"_Flatbread " boolean,"_Flight Instruction " boolean,"_Florists " boolean,"_Flowers & Gifts " boolean,"_Fondue " boolean,"_Food " boolean,"_Food Court " boolean,"_Food Delivery Services " boolean,"_Food Stands " boolean,"_Food Trucks " boolean,"_Franconian " boolean,"_French " boolean,"_Fruits & Veggies " boolean,"_Funeral Services & Cemeteries " boolean,"_Furniture Stores " boolean,"_Game Meat " boolean,"_Gardeners " boolean,"_Gas Stations " boolean,"_Gastropubs " boolean,"_Gay Bars " boolean,"_Georgian " boolean,"_German " boolean,"_Gift Shops " boolean,"_Gluten-Free " boolean,"_Golf " boolean,"_Greek " boolean,"_Grocery " boolean,"_Guest Houses " boolean,"_Gyms " boolean,"_Hair Salons " boolean,"_Halal " boolean,"_Hardware Stores " boolean,"_Hawaiian " boolean,"_Health Markets " boolean,"_Health & Medical " boolean,"_Heating & Air Conditioning/HVAC " boolean,"_Herbs & Spices " boolean,"_Hessian " boolean,"_Hiking " boolean,"_Himalayan/Nepalese " boolean,"_Home Decor " boolean,"_Home Services " boolean,"_Hookah Bars " boolean,"_Horseback Riding " boolean,"_Hospitals " boolean,"_Hostels " boolean,"_Hot Dogs " boolean,"_Hotels " boolean,"_Hotels & Travel " boolean,"_Hungarian " boolean,"_Ice Cream & Frozen Yogurt " boolean,"_Imported Food " boolean,"_Indian " boolean,"_Indonesian " boolean,"_Indoor Playcentre " boolean,"_Insurance " boolean,"_International " boolean,"_International Grocery " boolean,"_Internet Cafes " boolean,"_Irish " boolean,"_Irish Pub " boolean,"_Israeli " boolean,"_Italian " boolean,"_IT Services & Computer Repair " boolean,"_Japanese " boolean,"_Jazz & Blues " boolean,"_Jewelry " boolean,"_Jewish " boolean,"_Juice Bars & Smoothies " boolean,"_Karaoke " boolean,"_Kebab " boolean,"_Keys & Locksmiths " boolean,"_Kids Activities " boolean,"_Kiosk " boolean,"_Knitting Supplies " boolean,"_Korean " boolean,"_Kosher " boolean,"_LAN Centers " boolean,"_Landmarks & Historical Buildings " boolean,"_Landscaping " boolean,"_Laotian " boolean,"_Laser Tag " boolean,"_Latin American " boolean,"_Laundromat " boolean,"_Laundry Services " boolean,"_Lawyers " boolean,"_Lebanese " boolean,"_Libraries " boolean,"_Lighting Fixtures & Equipment " boolean,"_Live/Raw Food " boolean,"_Local Flavor " boolean,"_Local Services " boolean,"_Lounges " boolean,"_Macarons " boolean,"_Malaysian " boolean,"_Marketing " boolean,"_Massage " boolean,"_Mass Media " boolean,"_Meat Shops " boolean,"_Mediators " boolean,"_Medical Spas " boolean,"_Mediterranean " boolean,"_Mens Clothing " boolean,"_Mexican " boolean,"_Middle Eastern " boolean,"_Middle Schools & High Schools " boolean,"_Midwives " boolean,"_Mini Golf " boolean,"_Mobile Phones " boolean,"_Modern European " boolean,"_Mongolian " boolean,"_Moroccan " boolean,"_Mosques " boolean,"_Motorcycle Dealers " boolean,"_Mountain Huts " boolean,"_Mulled Wine " boolean,"_Museums " boolean,"_Musical Instruments & Teachers " boolean,"_Music & DVDs " boolean,"_Music Venues " boolean,"_Nail Salons " boolean,"_Naturopathic/Holistic " boolean,"_Newspapers & Magazines " boolean,"_Nightlife " boolean,"_Northern German " boolean,"_Nurseries & Gardening " boolean,"_Organic Stores " boolean,"_Oriental " boolean,"_Outlet Stores " boolean,"_Pakistani " boolean,"_Palatine " boolean,"_Pan Asian " boolean,"_Parent Cafes " boolean,"_Parks " boolean,"_Party & Event Planning " boolean,"_Party Supplies " boolean,"_Patisserie/Cake Shop " boolean,"_Pensions " boolean,"_Performing Arts " boolean,"_Persian/Iranian " boolean,"_Peruvian " boolean,"_Pet Adoption " boolean,"_Pets " boolean,"_Pet Training " boolean,"_Photographers " boolean,"_Photography Stores & Services " boolean,"_Physical Therapy " boolean,"_Piano Bars " boolean,"_Pizza " boolean,"_Playgrounds " boolean,"_Polish " boolean,"_Pool Halls " boolean,"_Pop-Up Restaurants " boolean,"_Portuguese " boolean,"_Potatoes " boolean,"_Pretzels " boolean,"_Print Media " boolean,"_Public Services & Government " boolean,"_Public Transportation " boolean,"_Pubs " boolean,"_Radio Stations " boolean,"_Ramen " boolean,"_Real Estate Agents " boolean,"_Recreation Centers " boolean,"_Religious Organizations " boolean,"_Restaurants " boolean,"_Restaurant Supplies " boolean,"_Rest Stops " boolean,"_Retirement Homes " boolean,"_Rhinelandian " boolean,"_Romanian " boolean,"_Russian " boolean,"_RV Parks " boolean,"_Salad " boolean,"_Sandwiches " boolean,"_Saunas " boolean,"_Scandinavian " boolean,"_Schnitzel " boolean,"_Seafood " boolean,"_Seafood Markets " boolean,"_Serbo Croatian " boolean,"_Shared Office Spaces " boolean,"_Shoe Repair " boolean,"_Shopping " boolean,"_Shopping Centers " boolean,"_Singaporean " boolean,"_Skate Shops " boolean,"_Skin Care " boolean,"_Soccer " boolean,"_Social Clubs " boolean,"_Soup " boolean,"_Souvenir Shops " boolean,"_Spanish " boolean,"_Specialty Food " boolean,"_Specialty Schools " boolean,"_Sporting Goods " boolean,"_Sports Bars " boolean,"_Sports Clubs " boolean,"_Sri Lankan " boolean,"_Stadiums & Arenas " boolean,"_Steakhouses " boolean,"_Street Vendors " boolean,"_Surf Shop " boolean,"_Sushi Bars " boolean,"_Swabian " boolean,"_Swimming Lessons/Schools " boolean,"_Swimming Pools " boolean,"_Swiss Food " boolean,"_Syrian " boolean,"_Tabletop Games " boolean,"_Tableware " boolean,"_Taiwanese " boolean,"_Tapas Bars " boolean,"_Tapas/Small Plates " boolean,"_Tasting Classes " boolean,"_Tattoo " boolean,"_Taxis " boolean,"_Tea Rooms " boolean,"_Tennis " boolean,"_Tex-Mex " boolean,"_Thai " boolean,"_Themed Cafes " boolean,"_Thrift Stores " boolean,"_Ticket Sales " boolean,"_Tobacco Shops " boolean,"_Tours " boolean,"_Toy Stores " boolean,"_Train Stations " boolean,"_Transportation " boolean,"_Travel Agents " boolean,"_Travel Services " boolean,"_Turkish " boolean,"_Ukrainian " boolean,"_Used Bookstore " boolean,"_Used, Vintage & Consignment " boolean,"_Vacation Rental Agents " boolean,"_Vacation Rentals " boolean,"_Vegan " boolean,"_Vegetarian " boolean,"_Venues & Event Spaces " boolean,"_Vietnamese " boolean,"_Vinyl Records " boolean,"_Waffles " boolean,"_Walking Tours " boolean,"_Wedding Planning " boolean,"_Whiskey Bars " boolean,"_Wine Bars " boolean,"_Wineries " boolean,"_Wine Tasting Classes " boolean,"_Wine Tasting Room " boolean,"_Wok " boolean,"_Womens Clothing " boolean,"_Yoga " boolean,"_Youth Club " boolean,"_Zoos" boolean
 )
 );




 

 
 