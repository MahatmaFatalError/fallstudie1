\subsection{Inductive Analysis}
\label{subsec:analysis}


\paragraph{Setup \& Assumptions}
Starting with the technical setup, it should be mentioned that the following analyses were calculated with the R programming language. Each approach follows the same procedure: Preparation and loading of the to be analyzed data via SQL, application of the appropriate analysis methods, interpretation of their results and finally storage of them to be available for further reuse.\newline
A foundational assumption of the following approaches is the positive impact of increasing Yelp's star rating on the revenue of a restaurant, which is a essential finding of \cite{CaseOfYelp}\footnote{Under certain circumstances like no affiliation of the restaurant to a chain.}. Based on this, statistic methods are applied to investigate which features lead to good restaurant ratings and also to build a predictive model to find a optimal solution.


\paragraph{1st Approach -  Regression Analysis}
The first analytical method conducted is multiple linear regression. As the Yelp rating is ratio scaled this method can be applied since it allows for metric scaled dependent variables as well as nominal and metric scaled independent variables. The regression equation is as follows: 

\begin{equation}
	\begin{aligned}
	\mathrm{rating}_{r} = \beta_{0} 
	&+ \beta_{1}  \mathrm{price.range}_{r} \\
	&+ \beta_{2}  \mathrm{review.count}_{r} \\
	&+ \beta_{3}  \mathrm{category1}_{r}    \\
	&+ \beta_{4}  \mathrm{category2}_{r} \\
	&+ \beta_{5}  \mathrm{category3}_{r} \\
	&+ \beta_{6}  \mathrm{state}_{r}   \\
	&+ \beta_{7}  \mathrm{population.sqkm}_{cr}  \\
	&+ \beta_{8}  \mathrm{buying.power}_{cr} + \epsilon
	\end{aligned}
	\label{eq:rating_regression}
\end{equation}
where $rating_r$ is the rating for restaurant $r$, $price.range_r$ is the categorical cost per person for a meal incl. one drink, tax and tip\footnote{Factor with 4 levels: \euro (up to 10\euro),\euro\euro (11\euro - 30\euro), \euro\euro\euro (31\euro - 60\euro), \euro\euro\euro\euro (above 61\euro) } for restaurant $r$, $review.count$ is the number of ratings that are given for restaurant $r$, $category1-3_r$ are the up to three culinary categories for restaurant $r$, $state_r$ is the federal state in which restaurant $r$ is located in, $population.sqkm_{cr}$ is the population per square kilometer of the city $c$ in which restaurant $r$ is located in, $buying.power_{cr}$ is the buying power for the city $c$ in which restaurant $r$ is located in. \newline
The result shows that  intercept $\beta_{0}$, $price.range_r$, $review.count$, $population.sqkm_{cr}$ and 
$buying.power_{cr}$ do have a significant effect onto $rating_r$. Due to the fact that the categories are distributed over 421 distinct values and can be combined 3 times, no significant impact of a certain category can be found. Unfortunately, even the significant variables are not reliable since $adjusted$ $ R^2$ only scores 0.05312 which indicates that the regression model only predicts very little variance in the dependent variable and is therefor not appropriate to predict a restaurants rating.


\paragraph{2nd Approach - Recursive Partitioning}
Since the previous approach hardly allows for interpretation, the choice of the next attempt falls on a method that is known to be easily readable: Decision Trees. As R provides many implementations of decision trees we want to focus on the most common techniques: \textit{Classification and Regression Trees} (CART), \textit{Random Forrest} and \textit{Unbiased Conditional Inference Trees}.\newline
For calculation of the tree models the same independent variables are chosen except the categories as they have to many factors which would reduce readability of a tree. The results, however, are doubtful. The CART model only contains a single root while the calculation of the Random Forest model runs for a unacceptable period of time. Only the model of the Unbiased Conditional Inference Tree delivers clear results which are shown in \ref{fig:ctree}. 
While the tree is easy to read, its leafs are doubtful as they result in a similar distribution of ratings, depicted by box plots.
Interestingly, the tree lacks a decision node based on the review counts which has been significant in the regression model.
After checking the trained model on the basis of test data for cross-validation, the already suspected result is confirmed: $R^2$ of 0.00236 confirms the assumption that crucial independent variables are missing in the data.
\bildWOCite{kapitel/unterkapitel/results/ctree.png}{Unbiased Conditional Inference Tree of Yelp restaurant data}{ctree}{}{}
 
\paragraph{3rd Approach - Benchmarking of Potential}
The preceding results substantiate lack of essential information which would be necessary in order to achieve proper prediction quality. Hence, this approach reclaims basic ranking techniques to calculate a Key Performance Indicator (KPI) which states the suitability of a city in combination with a food category.\newline
First of all, a list of cities ordered by their general potential fit needs to be generated. In order to calculate this synthetic potential KPI we propose the following equation:
\begin{equation}
\begin{aligned}
	potential_c = &SoftMax(\frac{population.sqkm_c}{restaurants.sqkm_c})  \\
	\times & SoftMax(\textstyle \sum reviewcount_{cr})  \\
	\times & SoftMax(\varnothing rating_{cr}) %^\prime 
\end{aligned}
\label{eq:potential_benchmark}
\end{equation}

where $potential_c$ is the potential of a city expressed by a floating-point number between 0 and 1,  $(\frac{population.sqkm_c}{restaurants.sqkm_c})$ is the quotient of average population per square kilometer per city by average restaurant density per square kilometer per city, $\sum reviewcount_{cr}$ is the sum of all restaurant reviews per city and $\varnothing rating_{cr}$ is the average restaurant rating per city. In order to weight the factors equally each of them needs to be standardized, i.e. their values  gets compressed to a continuous variable ranging from 0 to 1 via the $SoftMax$ function.\newline
To avoid blurring the results with unrepresentative cities, the following conditions needs to be fulfilled in order to be taken into account as a potential city: 

\begin{equation}
\begin{aligned}
reviewcount_{r} &\geq \varnothing reviewcount_{r} \\
reviewcount_{rc} &\geq \varnothing reviewcount_{rc} \\
\sum restaurants_{c} &\geq \varnothing \sum restaurants_{c} 
\end{aligned}
\label{eq:potential_condition}
\end{equation}

For the given data this yields to $reviewcount_{r} \geq 10 $, $reviewcount_{rc} \geq 28$ and $\sum restaurants_{c} \geq 138$.

\begin{table}[!htbp] \centering 
	\caption{} 
	\label{} 
	\begin{tabular}{@{\extracolsep{5pt}}lccccccc} 
		\\[-1.8ex]\hline 
		\hline \\[-1.8ex] 
		Statistic & \multicolumn{1}{c}{N} & \multicolumn{1}{c}{Mean} & \multicolumn{1}{c}{St. Dev.} & \multicolumn{1}{c}{Min} & \multicolumn{1}{c}{Pctl(25)} & \multicolumn{1}{c}{Pctl(75)} & \multicolumn{1}{c}{Max} \\ 
		\hline \\[-1.8ex] 
		reviews & 70,875 & 10.238 & 20.934 & 0 & 2 & 10 & 837 \\ 
		reviews in city  & 3,032 & 306.393 & 4,158.057 & 0 & 4 & 79 & 173,471 \\
		restaurants in city & 3,032 & 28.560 & 194.364 & 1 & 1 & 20 & 8,203 \\  
		\hline \\[-1.8ex] 
	\end{tabular} 
\end{table} 
%TODO zahlen checken 
% bedingungen:  review_count >= 9  sum(review_count)  > 138 and count(review_count) >= 28

%- Ranking Algorithm
%- KPI Formula
%- contingency analysis 
%- χ2 test


% wir bräuchten eignetlich noc hTouristik Daten damit wir wissenm wieviel Leute die Stadt besuchen